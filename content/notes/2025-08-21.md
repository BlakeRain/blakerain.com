---
title: Roundcube IMAP/SMTP TLS Certificates in Docker
link: https://github.com/roundcube/roundcubemail/wiki/FAQ#problems-connecting-imapsmtp-server-via-ssltls
date: 2025-08-21
---

I recently deployed [Roundcube] in Docker to provide a webmail interface. Roundcube runs in a Docker
network alongside the IMAP and SMTP servers (Dovecot and Postfix). In the Docker environment for
Roundcube I provided the IMAP and SMTP server hostnames:

```yaml
services:
  roundcube:
    environment:
      - ROUNDCUBEMAIL_DEFAULT_HOST=ssl://imap
      - ROUNDCUBEMAIL_DEFAULT_PORT=993
      - ROUNDCUBEMAIL_SMTP_SERVER=ssl://smtp
      - ROUNDCUBEMAIL_SMTP_PORT=465
```

Unfortunately, authentication didn't work. The error that I was getting in the Roundcube logs was
not very helpful:

```
errors: <74833690> IMAP Error: Login failed for ****@****.com
  against imap from <local-IP> (X-Forwarded-For: <my-IP>).
  Could not connect to ssl://imap:993: Unknown reason in
  /var/www/html/program/lib/Roundcube/rcube_imap.php on line 211 (POST /?_task=login&_action=login)`
```

The error `Unknown reason` is not very helpful. I wondered if there was any information in the
Dovecot logs. Dovceot only reported that the connection was closed:

```
imap-login: Info: Disconnected: Connection closed (no auth attempts in 0 secs):
  user=<>, rip=<roundcube-IP>, lip=<imap-IP>, TLS, session=<f/....>
```

The interesting thing here was that there were no authentication attempts. This led me down a few
false paths, such as checking that Roundcube supports the authentication methods (surely it does!),
and that I could complete a TLS connection from the Roundcube container to the IMAP server. I tested
the latter with `openssl s_client -connect imap:993` from the Roundcube container, and the
connection was successful.

Turns out that the issue is that Roundcube expects the TLS certificate of the IMAP and SMTP servers
to be signed by a trusted CA, and for the CN of the certificate to match the hostname given in the
`ROUNDCUBEMAIL_DEFAULT_HOST` and `ROUNDCUBEMAIL_SMTP_SERVER` environment variables ü§¶‚Äç‚ôÇÔ∏è

To fix this, I had to change the Roundcube configuration to use the FQN of the mail server, rather
than the internal Docker hostname:

```yaml
services:
  roundcube:
    environment:
      - ROUNDCUBEMAIL_DEFAULT_HOST=ssl://mail.example.com
      - ROUNDCUBEMAIL_DEFAULT_PORT=993
      - ROUNDCUBEMAIL_SMTP_SERVER=ssl://mail.example.com
      - ROUNDCUBEMAIL_SMTP_PORT=465
```

Turns out this is documented at the bottom of the FAQ page on Roundcube's GitHub wiki.

[Roundcube]: https://roundcube.net/
